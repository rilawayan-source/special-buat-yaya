<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Heart Animation</title>
    <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        .container {
            text-align: center;
            position: relative;
            width: 800px;
            height: 600px;
        }
        canvas {
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.3);
            background-color: transparent;
            position: relative;
            z-index: 1;
        }
        .info {
            color: #aaa;
            margin-top: 15px;
            font-size: 16px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            position: relative;
            z-index: 5;
        }
        .counter {
            color: #ff3366;
            font-weight: bold;
            font-size: 18px;
            margin-top: 10px;
            position: relative;
            z-index: 5;
        }
        .birthday-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 48px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            transition: opacity 0.5s ease;
        }
        .message-line {
            display: flex;
            gap: 5px;
        }
        .letter {
            opacity: 0;
            animation: glow 1.5s infinite alternate;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 5px #fff, 0 0 10px #ff3366, 0 0 15px #ff3366, 0 0 20px #ff3366;
            }
            to {
                text-shadow: 0 0 10px #fff, 0 0 20px #ff3366, 0 0 30px #ff3366, 0 0 40px #ff3366;
            }
        }
        .message-button {
            position: absolute;
            top: 65%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #ff3366, #ff0044);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 51, 102, 0.5);
            z-index: 15;
        }
        .message-button:hover {
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 0 25px rgba(255, 51, 102, 0.8);
        }
        .show {
            opacity: 1 !important;
        }
        .hidden-message {
            position: absolute;
            top: 75%;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 24px;
            text-align: center;
            opacity: 0;
            transition: opacity 1s ease;
            z-index: 15;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 30px;
            border-radius: 15px;
            max-width: 500px;
        }
        .show-message {
            opacity: 1;
        }
        
        /* Tombol untuk animasi kedua */
        .second-animation-button {
            position: absolute;
            top: 85%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #3399ff, #0066cc);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(51, 153, 255, 0.7);
            z-index: 20;
            pointer-events: auto;
        }
        .second-animation-button:hover {
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 0 30px rgba(51, 153, 255, 0.9);
        }
        
        /* Container untuk animasi kedua */
        .second-animation-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 25;
            display: none;
            opacity: 0;
            transition: opacity 1s ease;
        }
        
        .second-animation-container.active {
            display: block;
            opacity: 1;
            pointer-events: all;
        }
        
        /* Styling untuk animasi I Love You */
        #ui {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #ui .love {
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -225px 0 0 -225px;
        }

        #ui .love_word {
            color: #ea80b0;
            font-size: 1.4rem;
            transform: translateY(-100%) rotateZ(-30deg);
            text-shadow: 0 0 10px #fff;
            letter-spacing: 2px;
            font-weight: 600;
            opacity: 0.9;
            transition: all 0.3s ease;
            font-family: 'Dosis', sans-serif;
        }

        #ui .love_word:hover {
            text-shadow: 0 0 15px #ff4d6d, 0 0 25px #ff4d6d, 0 0 35px #ff4d6d;
            transform: translateY(-100%) rotateZ(-30deg) scale(1.2);
            z-index: 100;
        }

        #ui .love_horizontal {
            animation: horizontal 10000ms infinite alternate ease-in-out;
        }

        #ui .love_vertical {
            animation: vertical 20000ms infinite linear;
        }

        @keyframes horizontal {
            from {
                transform: translateX(0px);
            }
            to {
                transform: translateX(450px);
            }
        }

        @keyframes vertical {
            0% {
                transform: translateY(180px);
            }
            10% {
                transform: translateY(45px);
            }
            15% {
                transform: translateY(4.5px);
            }
            18% {
                transform: translateY(0px);
            }
            20% {
                transform: translateY(4.5px);
            }
            22% {
                transform: translateY(34.61538px);
            }
            24% {
                transform: translateY(64.28571px);
            }
            25% {
                transform: translateY(112.5px);
            }
            26% {
                transform: translateY(64.28571px);
            }
            28% {
                transform: translateY(34.61538px);
            }
            30% {
                transform: translateY(4.5px);
            }
            32% {
                transform: translateY(0px);
            }
            35% {
                transform: translateY(4.5px);
            }
            40% {
                transform: translateY(45px);
            }
            50% {
                transform: translateY(180px);
            }
            71% {
                transform: translateY(428.57143px);
            }
            72.5% {
                transform: translateY(441.17647px);
            }
            75% {
                transform: translateY(450px);
            }
            77.5% {
                transform: translateY(441.17647px);
            }
            79% {
                transform: translateY(428.57143px);
            }
            100% {
                transform: translateY(180px);
            }
        }

        .love-controls {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 30;
        }

        .love-control-btn {
            background: rgba(255, 77, 109, 0.2);
            color: white;
            border: 1px solid #ff4d6d;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-family: 'Dosis', sans-serif;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .love-control-btn:hover {
            background: rgba(255, 77, 109, 0.4);
            transform: scale(1.05);
        }

        .floating-hearts {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-heart {
            position: absolute;
            font-size: 20px;
            color: #ea80b0;
            opacity: 0;
            animation: float 8s linear infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Class untuk menyembunyikan elemen animasi pertama */
        .hide-first-animation {
            opacity: 0 !important;
            pointer-events: none !important;
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <canvas id="myCanvas" width="800" height="600"></canvas>
        <div class="info">Animation will stop after completing 3 full hearts</div>
        <div class="counter" id="counter">Hearts drawn: <span id="heartCount">0</span>/3</div>
        
        <div class="birthday-message" id="birthdayMessage">
            <div class="message-line" id="line1">
                <span class="letter">H</span>
                <span class="letter">a</span>
                <span class="letter">p</span>
                <span class="letter">p</span>
                <span class="letter">y</span>
                <span class="letter">&nbsp;</span>
                <span class="letter">B</span>
                <span class="letter">i</span>
                <span class="letter">r</span>
                <span class="letter">t</span>
                <span class="letter">h</span>
                <span class="letter">d</span>
                <span class="letter">a</span>
                <span class="letter">y</span>
            </div>
            <div class="message-line" id="line2">
                <span class="letter">y</span>
                <span class="letter">a</span>
                <span class="letter">y</span>
                <span class="letter">a</span>
                <span class="letter">a</span>
                <span class="letter">a</span>
                <span class="letter">!</span>
            </div>
        </div>
        
        <button class="message-button" id="messageButton">Click for Special Message</button>
        
        <div class="hidden-message" id="hiddenMessage">
            Hi yayaaa, happy special day to you, thank you for being in my life!<br>
            May all your dreams and wishes come true! i love u yayaaa ü´∂üèªü´∞üèªüêª
        </div>
        
        <!-- Tombol untuk animasi kedua -->
        <button class="second-animation-button" id="secondAnimationButton">üéâ Start special Animation! üéâ</button>
        
        <!-- Container untuk animasi kedua -->
        <div class="second-animation-container" id="secondAnimationContainer">
            <div id="ui">
                <!-- Love elements will be generated by JavaScript -->
            </div>

            <div class="floating-hearts" id="floatingHearts"></div>

            <div class="love-controls">
                <button class="love-control-btn" id="toggleGlow">Efek Menyala</button>
            </div>
        </div>
    </div>

    <script>
        // ===== ANIMASI PERTAMA (HAPPY BIRTHDAY) =====
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const heartCountElement = document.getElementById('heartCount');
        const birthdayMessage = document.getElementById('birthdayMessage');
        const messageButton = document.getElementById('messageButton');
        const hiddenMessage = document.getElementById('hiddenMessage');
        const secondAnimationButton = document.getElementById('secondAnimationButton');
        const secondAnimationContainer = document.getElementById('secondAnimationContainer');
        const infoElement = document.querySelector('.info');
        const counterElement = document.querySelector('.counter');

        // Center of the canvas
        const centerX = 400;
        const centerY = 300;

        // Arrays untuk menyimpan floating elements
        const floatingHearts = [];
        const floatingStars = [];

        // Array untuk menyimpan garis-garis love yang sudah digambar
        const loveLines = [];

        // Function to compute heart x
        function hearta(k) {
            return 15 * Math.pow(Math.sin(k), 3);
        }

        // Function to compute heart y
        function heartb(k) {
            return 12 * Math.cos(k) - 5 * Math.cos(2 * k) - 2 * Math.cos(3 * k) - Math.cos(4 * k);
        }

        let i = 0;
        let heartCounter = 0;
        let isStopped = false;
        const pointsPerHeart = 628;
        
        const speedMultiplier = 3.0;

        // Start floating elements animation
        startFloatingElements();

        const startTime = Date.now();
        const targetTime = 10000;

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            redrawLoveLines();

            if (!isStopped) {
                const elapsedTime = Date.now() - startTime;
                const progress = Math.min(elapsedTime / targetTime, 1);
                
                const targetI = Math.floor(progress * pointsPerHeart * 3);
                
                while (i < targetI && !isStopped) {
                    let k = i * 0.01 * speedMultiplier;
                    let x = hearta(k) * 20 + centerX;
                    let y = centerY - heartb(k) * 20;

                    // Draw line from (x, y) to center
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    ctx.lineTo(centerX, centerY);
                    
                    const gradient = ctx.createLinearGradient(centerX, centerY, x, y);
                    gradient.addColorStop(0, '#ff3366');
                    gradient.addColorStop(1, '#ff0000');
                    
                    ctx.strokeStyle = gradient;
                    ctx.lineWidth = 1.5;
                    ctx.stroke();

                    // Simpan garis yang baru digambar
                    loveLines.push({
                        x1: x, y1: y, x2: centerX, y2: centerY,
                        gradient: gradient,
                        color: ctx.strokeStyle
                    });

                    i++;
                    
                    const currentHeartNumber = Math.floor(i / pointsPerHeart);
                    
                    if (currentHeartNumber > heartCounter) {
                        heartCounter = currentHeartNumber;
                        heartCountElement.textContent = heartCounter;
                        
                        if (heartCounter >= 3) {
                            isStopped = true;
                            showBirthdayMessage();
                            break;
                        }
                    }
                    
                    if (i >= targetI) break;
                }

                if (elapsedTime >= targetTime && !isStopped) {
                    isStopped = true;
                    showBirthdayMessage();
                }
            }

            drawFloatingElements();
            
            requestAnimationFrame(animate);
        }

        function redrawLoveLines() {
            loveLines.forEach(line => {
                ctx.beginPath();
                ctx.moveTo(line.x1, line.y1);
                ctx.lineTo(line.x2, line.y2);
                
                if (line.gradient) {
                    ctx.strokeStyle = line.gradient;
                } else {
                    ctx.strokeStyle = line.color;
                }
                
                ctx.lineWidth = 1.5;
                ctx.stroke();
            });
        }

        function drawFloatingElements() {
            // Draw hearts
            floatingHearts.forEach((heart, index) => {
                ctx.save();
                ctx.translate(heart.x, heart.y);
                ctx.rotate(heart.rotation);
                ctx.scale(heart.scale, heart.scale);
                
                ctx.fillStyle = heart.color;
                ctx.font = `${heart.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                ctx.shadowColor = '#ff3366';
                ctx.shadowBlur = 10;
                ctx.fillText('‚ù§', 0, 0);
                
                ctx.restore();
                
                heart.y += heart.speed;
                heart.rotation += heart.rotationSpeed;
                
                if (heart.y > canvas.height + 50) {
                    floatingHearts.splice(index, 1);
                }
            });

            // Draw stars
            floatingStars.forEach((star, index) => {
                ctx.save();
                ctx.translate(star.x, star.y);
                ctx.rotate(star.rotation);
                ctx.scale(star.scale, star.scale);
                
                ctx.fillStyle = star.color;
                ctx.font = `${star.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                ctx.shadowColor = '#ffff00';
                ctx.shadowBlur = 10;
                ctx.fillText('‚òÖ', 0, 0);
                
                ctx.restore();
                
                star.y += star.speed;
                star.rotation += star.rotationSpeed;
                
                if (star.y > canvas.height + 50) {
                    floatingStars.splice(index, 1);
                }
            });
        }

        function createFloatingHeart() {
            floatingHearts.push({
                x: Math.random() * canvas.width,
                y: -20,
                size: Math.random() * 12 + 8,
                speed: Math.random() * 2 + 1,
                rotation: Math.random() * Math.PI * 2,
                rotationSpeed: (Math.random() - 0.5) * 0.1,
                scale: Math.random() * 0.3 + 0.7,
                color: '#ff3366'
            });
        }

        function createFloatingStar() {
            floatingStars.push({
                x: Math.random() * canvas.width,
                y: -20,
                size: Math.random() * 10 + 6,
                speed: Math.random() * 1.5 + 0.8,
                rotation: Math.random() * Math.PI * 2,
                rotationSpeed: (Math.random() - 0.5) * 0.08,
                scale: Math.random() * 0.3 + 0.7,
                color: '#ffff00'
            });
        }

        function startFloatingElements() {
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createFloatingHeart();
                    createFloatingStar();
                }, i * 300);
            }
            
            setInterval(() => {
                createFloatingHeart();
                createFloatingStar();
            }, 500);
        }

        function showBirthdayMessage() {
            const line1 = document.getElementById('line1');
            const line2 = document.getElementById('line2');
            const letters1 = line1.querySelectorAll('.letter');
            const letters2 = line2.querySelectorAll('.letter');
            
            let delay = 0;
            
            letters1.forEach((letter, index) => {
                setTimeout(() => {
                    letter.style.opacity = 1;
                }, delay);
                delay += 120;
            });
            
            delay += 500;
            
            letters2.forEach((letter, index) => {
                setTimeout(() => {
                    letter.style.opacity = 1;
                    
                    if (index === letters2.length - 1) {
                        setTimeout(() => {
                            messageButton.classList.add('show');
                        }, 500);
                    }
                }, delay);
                delay += 120;
            });
        }

        // Event listener untuk tombol PERTAMA (Special Message)
        messageButton.addEventListener('click', function() {
            console.log('Tombol pesan spesial diklik');
            
            // Tampilkan pesan spesial
            hiddenMessage.classList.add('show-message');
            messageButton.style.display = 'none';
            
            // Create special floating hearts
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    floatingHearts.push({
                        x: Math.random() * canvas.width,
                        y: canvas.height + 20,
                        size: Math.random() * 15 + 12,
                        speed: -Math.random() * 2 - 1,
                        rotation: Math.random() * Math.PI * 2,
                        rotationSpeed: (Math.random() - 0.5) * 0.1,
                        scale: Math.random() * 0.3 + 0.7,
                        color: '#ff3366'
                    });
                }, i * 150);
            }
            
            // Tampilkan tombol kedua setelah 2 detik
            setTimeout(() => {
                console.log('Menampilkan tombol animasi kedua');
                secondAnimationButton.style.display = 'block';
                secondAnimationButton.classList.add('show');
            }, 2000);
        });

        // ===== ANIMASI KEDUA (I LOVE YOU HEART FORMATION) =====
        function startSecondAnimation() {
            console.log('Memulai animasi kedua');
            
            // Sembunyikan semua elemen animasi pertama
            hideFirstAnimationElements();
            
            // Tampilkan animasi kedua dengan efek transisi
            setTimeout(() => {
                secondAnimationContainer.classList.add('active');
                
                // Inisialisasi animasi I Love You
                createLoveElements();
                createFloatingHeartsForSecondAnimation();
                
                // Setup event listener untuk efek glow
                document.getElementById('toggleGlow').addEventListener('click', toggleGlow);
            }, 500);
        }

        // Fungsi untuk menyembunyikan elemen animasi pertama
        function hideFirstAnimationElements() {
            console.log('Menyembunyikan animasi pertama');
            
            // Sembunyikan canvas dan elemen terkait
            canvas.style.opacity = '0';
            infoElement.classList.add('hide-first-animation');
            counterElement.classList.add('hide-first-animation');
            birthdayMessage.classList.add('hide-first-animation');
            hiddenMessage.classList.add('hide-first-animation');
            secondAnimationButton.classList.add('hide-first-animation');
            
            // Hentikan animasi canvas
            isStopped = true;
        }

        // Create love elements untuk animasi kedua
        function createLoveElements() {
            const ui = document.getElementById('ui');
            const totalElements = 100;
            
            for (let i = 0; i < totalElements; i++) {
                const loveDiv = document.createElement('div');
                loveDiv.className = 'love';
                
                const horizontalDiv = document.createElement('div');
                horizontalDiv.className = 'love_horizontal';
                
                const verticalDiv = document.createElement('div');
                verticalDiv.className = 'love_vertical';
                
                const wordDiv = document.createElement('div');
                wordDiv.className = 'love_word';
                wordDiv.textContent = 'I Love You';
                
                verticalDiv.appendChild(wordDiv);
                horizontalDiv.appendChild(verticalDiv);
                loveDiv.appendChild(horizontalDiv);
                ui.appendChild(loveDiv);
                
                // Set animation delays
                const delay = -(i + 1) * 300;
                horizontalDiv.style.animationDelay = `${delay}ms`;
                verticalDiv.style.animationDelay = `${delay}ms`;
            }
        }
        
        // Create floating hearts untuk animasi kedua
        function createFloatingHeartsForSecondAnimation() {
            const container = document.getElementById('floatingHearts');
            const heartCount = 20;
            
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('floating-heart');
                heart.innerHTML = '‚ù§Ô∏è';
                
                // Random position and animation delay
                const left = Math.random() * 100;
                const delay = Math.random() * 5;
                const duration = 6 + Math.random() * 4;
                
                heart.style.left = `${left}%`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                
                container.appendChild(heart);
            }
        }
        
        // Control glow effect untuk animasi kedua
        let glowEnabled = true;
        
        function toggleGlow() {
            glowEnabled = !glowEnabled;
            const words = document.querySelectorAll('.love_word');
            
            words.forEach(word => {
                if (glowEnabled) {
                    word.style.textShadow = '0 0 10px #fff, 0 0 20px #ea80b0, 0 0 30px #ff4d6d';
                } else {
                    word.style.textShadow = '0 0 5px #ea80b0';
                }
            });
            
            document.getElementById('toggleGlow').textContent = 
                glowEnabled ? 'Kurangi Efek' : 'Efek Menyala';
        }

        // Event listener untuk tombol KEDUA (Start special Animation!)
        secondAnimationButton.addEventListener('click', function() {
            console.log('Tombol animasi kedua diklik');
            startSecondAnimation();
        });

        // Start the animation pertama
        animate();
    </script>
</body>
</html>